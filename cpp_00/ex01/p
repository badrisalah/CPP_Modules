/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   p                                                  :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: sabadri <sabadri@student.42.fr>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2025/10/17 04:11:55 by sabadri           #+#    #+#             */
/*   Updated: 2025/12/09 14:45:37 by sabadri          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "Phonebook.hpp"

int main() {
	PhoneBook phoneBook;
	std::string command;

	std::cout << " Welcome to My Awesome PhoneBook!" << std::endl;

	while (true)
	{
		std::cout << "Enter command (ADD, SEARCH, EXIT): ";
		std::cin>>command;

		if (std::cin.eof()) {
			std::cout << std::endl;
			break;
		}
		if (command == "ADD")
			phoneBook.add_contact();
		else if (command == "SEARCH")
			phoneBook.searchContact();
		else if (command == "EXIT")
			break;
	}
	std::cout << "! All contacts lost forever..." << std::endl;
	return 0;
}

NAME = phonebook
C++ = c++
C++FLAGS = -Wall -Wextra -Werror -std=c++98

SRCS = main.cpp Phonebook.cpp
OBJS = $(SRCS:.cpp=.o)

all: $(NAME)

$(NAME): $(OBJS)
	$(C++) $(C++FLAGS) -o $(NAME) $(OBJS)

%.o: %.cpp Phonebook.hpp
	$(C++) $(C++FLAGS) -c $< -o $@

clean:
	rm -f $(OBJS)

fclean: clean
	rm -f $(NAME)

re: fclean all
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   Phonebook.cpp                                      :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: sabadri <sabadri@student.42.fr>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2025/10/20 10:28:54 by sabadri           #+#    #+#             */
/*   Updated: 2025/12/09 14:35:37 by sabadri          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "Phonebook.hpp"

PhoneBook::PhoneBook() : contact_count(0), index(0) {}

void Contact::set_name(std::string name)
{
	Name = name;
}
void Contact::set_lname(std::string lname)
{
	LastName = lname;
}
void Contact::set_nname(std::string nname)
{
	NickName = nname;
}
void Contact::set_num(std::string number)
{
	Number = number;
}
void Contact::set_dsec(std::string dsecret)
{
	DarkestSecret = dsecret;
}
std::string Contact::get_fname()  {
	return Name;
}
std::string Contact::get_lname()  {
	return LastName;
}
std::string Contact::get_nname()  {
	return NickName;
}
std::string Contact::get_num()  {
	return Number;
}
std::string Contact::get_dsec()  {
	return DarkestSecret;
}
void Contact::display(){
	std::cout << "First Name: " << Name << "\n";
	std::cout << "Last Name: " << LastName << "\n";
	std::cout << "Nickname: " << NickName << "\n";
	std::cout << "Phone Number: " << Number << "\n";
	std::cout << "Darkest Secret: " << DarkestSecret << "\n";
}
std::string trunc(std::string s)
{
	if (s.size()<11)
		return s;
	std::string res = "          ";
	for(int i=0;i<9;i++)
	{
		res[i] = s[i];
	}
	std::string p = ".";
	res += p;
	return res;
}

int numcheck(std::string s)
{
	size_t j = s.size();
	for(size_t i=0;i<j;i++)
	{
		if (s[i] > '9' || s[i] < '1')
			return 1;
	}
	return 0;
}

int prntcheck(std::string const& fn, std::string const& ln, std::string const& nn, std::string const& ds)
{
	for(size_t i = 0;i<fn.size();i++)
	{
		if (fn[i] < 32 || fn[i] > 126)
			return 0;
	}
	for(size_t i = 0;i<ln.size();i++)
	{
		if (ln[i] < 32 || ln[i] > 126)
			return 0;
	}
	for(size_t i = 0;i<nn.size();i++)
	{
		if (nn[i] < 32 || nn[i] > 126)
			return 0;
	}
	for(size_t i = 0;i<ds.size();i++)
	{
		if (ds[i] < 32 || ds[i] > 126)
			return 0;
	}
	return 1;
}

void PhoneBook::add_contact()
{
    std::string fname, lname, nname, num, dsec;

    while (true)
    {
        std::cout << "Enter First Name : ";
        std::getline(std::cin, fname);
        if (std::cin.eof()) { std::cout << std::endl; return; }

        std::cout << "Enter Last Name : ";
        std::getline(std::cin, lname);
        if (std::cin.eof()) { std::cout << std::endl; return; }

        std::cout << "Enter NickName : ";
        std::getline(std::cin, nname);
        if (std::cin.eof()) { std::cout << std::endl; return; }

        std::cout << "Enter Number : ";
        std::getline(std::cin, num);
        if (std::cin.eof()) { std::cout << std::endl; return; }

        std::cout << "Enter Darkest Secret : ";
        std::getline(std::cin, dsec);
        if (std::cin.eof()) { std::cout << std::endl; return; }

        // validation
        if (!fname.empty() && !lname.empty() && !nname.empty() &&
            !num.empty() && !dsec.empty() &&
            !numcheck(num) && prntcheck(fname,lname,nname,dsec))
        {
            break;
        }
        std::cout << "Input Error\n";
    }

    // store data
    contacts[index].set_name(trunc(fname));
    contacts[index].set_lname(trunc(lname));
    contacts[index].set_nname(trunc(nname));
    contacts[index].set_num(trunc(num));
    contacts[index].set_dsec(trunc(dsec));

    // increase stored number count (max 8)
    if (contact_count < 8)
        contact_count++;

    // move index (0â€“7 circular)
    index = (index + 1) % 8;

    std::cout << "\n Contact added successfully!\n";
}


void PhoneBook::searchContact()
{
    if (index == 0)
    {
        std::cout << "Empty contact\n";
        return;
    }
    std::cout << "---------------------------------------------\n";
    std::cout << std::setw(10) << "Index" << "|"
              << std::setw(10) << "First Name" << "|"
              << std::setw(10) << "Last Name" << "|"
              << std::setw(10) << "Nickname" << "|\n";
    std::cout << "---------------------------------------------\n";
    for (int i = 0; i < index; i++)
    {
        std::cout << std::setw(10) << i << "|"
                  << std::setw(10) << contacts[i].get_fname() << "|"
                  << std::setw(10) << contacts[i].get_lname() << "|"
                  << std::setw(10) << contacts[i].get_nname() << "|\n";
    }
    std::string input;
    std::cout << "Enter which index you'd like to view: ";
    std::getline(std::cin, input);
    if (std::cin.eof())
    {
        std::cout << std::endl;
        return;
    }
    if (input.length() != 1 || !isdigit(input[0]))
    {
        std::cout << "Invalid input. Please enter a number.\n";
        return;
    }
    int x = input[0] - '0';
    if (x >= 0 && x < index)
    {
        std::cout << "First Name: " << contacts[x].get_fname() << std::endl;
        std::cout << "Last Name: " << contacts[x].get_lname() << std::endl;
        std::cout << "Nickname: " << contacts[x].get_nname() << std::endl;
        std::cout << "Number: " << contacts[x].get_num() << std::endl;
        std::cout << "Darkest Secret: " << contacts[x].get_dsec() << std::endl;
    }
    else
    {
        std::cout << "Index must be between 0 and " << (index - 1) << ".\n";
    }
}

/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   Phonebook.hpp                                      :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: sabadri <sabadri@student.42.fr>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2025/10/14 03:44:20 by sabadri           #+#    #+#             */
/*   Updated: 2025/10/22 09:38:45 by sabadri          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#ifndef PHONEBOOK_HPP
# define PHONEBOOK_HPP

#include <iostream>
#include <iomanip>

class Contact {
	private :
		std::string Name;
		std::string LastName;
		std::string NickName;
		std::string Number;
		std::string DarkestSecret;
	public :
		void set_name(std::string name);
		void set_lname(std::string lname);
		void set_nname(std::string nname);
		void set_num(std::string number);
		void set_dsec(std::string dsecret);
		std::string get_fname();
		std::string get_lname();
		std::string get_nname();
		std::string get_num();
		std::string get_dsec();
		void display();
};

class PhoneBook {
	private :
		Contact contacts[8];
		int contact_count;
		int index;
	public :
		PhoneBook();
		void add_contact();
		void searchContact();
};

#endif
